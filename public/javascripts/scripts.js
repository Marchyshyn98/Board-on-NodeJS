$(function(){function e(){$("form.login p.error, form.register p.error").remove(),$("form.login input, form.register input").removeClass("error")}var r=!0;$(".switch-button").on("click",function(o){o.preventDefault(),$("input").val(""),$("p.error").remove(),$("input").removeClass("error"),r?(r=!1,$(".register").show("slow"),$(".login").hide()):(r=!0,$(".login").show("slow"),$(".register").hide())}),$("form.login input, form.register input").on("focus",function(){e()}),$(".register-button").on("click",function(o){o.preventDefault(),e();var r={login:$("#register-login").val(),password:$("#register-password").val(),passwordConfirm:$("#register-password-confirm").val()};$.ajax({type:"POST",data:JSON.stringify(r),contentType:"application/json",url:"/api/auth/register"}).done(function(o){console.log(o),o.ok?location.reload():($(".register h2").after("<p class='error'>"+o.error+"</p>"),o.fields&&o.fields.forEach(function(o){$("input[name="+o+"]").addClass("error")}))})}),$(".login-button").on("click",function(o){o.preventDefault(),e();var r={login:$("#login-login").val(),password:$("#login-password").val()};$.ajax({type:"POST",data:JSON.stringify(r),contentType:"application/json",url:"/api/auth/login"}).done(function(o){console.log(o),o.ok?location.reload():($(".login h2").after("<p class='error'>"+o.error+"</p>"),o.fields&&o.fields.forEach(function(o){$("input[name="+o+"]").addClass("error")}))})})}),$(function(){function t(){$(".advert-form p.error").remove(),$(".advert-form input, .advert-form textarea").removeClass("error")}$("#advert-phone").inputmask("+380-999-99-99-99"),$(".advert-form input, .advert-form textarea").on("focus",function(){t()}),$(".publish-button, .save-button").on("click",function(o){o.preventDefault(),t();var r="save-button"===$(this).attr("class").split(" ")[0],e={title:$("#advert-title").val(),body:$("#advert-body").val(),phone:$("#advert-phone").val(),isDraft:r,advertId:$("#advert-id").val()};$.ajax({type:"POST",data:JSON.stringify(e),contentType:"application/json",url:"/advert/add"}).done(function(o){console.log(o),o.ok?$(location).attr("href","/"):($(".advert-form h2").after("<p class='error'>"+o.error+"</p>"),o.fields&&o.fields.forEach(function(o){$("#advert-"+o).addClass("error")}))})})}),$(function(){var t,n;function a(){$(".comment-list p.error").remove(),$(".comment textarea").removeClass("error")}$(".comment textarea").on("focus",function(){a()}),$("#new, #reply").on("click",function(){if(t&&t.remove(),n=null,t=$(".comment").clone(!0,!0),"new"===$(this).attr("id"))t.appendTo(".comment-list");else{var o=$(this).parent();n=o.attr("id"),$(this).after(t)}t.css({display:"flex"})}),$("form.comment .cancel").on("click",function(){e.preventDefault(),t.remove()}),$("form.comment .send").on("click",function(o){o.preventDefault(),a();var r={advert:$(".comments").attr("id"),body:t.find("textarea").val(),parent:n};$.ajax({type:"POST",data:JSON.stringify(r),contentType:"application/json",url:"/comment/add"}).done(function(o){console.log(o),o.ok?location.reload():($(".comment-body").addClass("error"),$(".comment").before("<p class='error'>"+o.error+"</p>"))})})});